---
const stats = [
  { value: '156+', label: 'Repositories', icon: 'üìÅ' },
  { value: '34+', label: 'Public Repos', icon: 'üåê' },
  { value: '5', label: 'NPM Packages', icon: 'üì¶' },
  { value: '500+', label: 'Migrations Led', icon: 'üöÄ' },
];

const topLangs = [
  { name: 'PowerShell', pct: 35, color: '#012456' },
  { name: 'TypeScript', pct: 25, color: '#3178C6' },
  { name: 'JavaScript', pct: 15, color: '#F7DF1E' },
  { name: 'C#', pct: 10, color: '#512BD4' },
  { name: 'HCL', pct: 8, color: '#7B42BC' },
  { name: 'Other', pct: 7, color: '#5A5A72' },
];
---

<section id="github-activity" class="min-h-screen py-20 px-6">
  <div class="max-w-5xl mx-auto">
    <!-- Section Header -->
    <div class="text-center mb-16">
      <h2 class="text-4xl md:text-5xl font-heading font-bold text-text-primary mb-4">
        GitHub Activity
      </h2>
      <div class="w-20 h-1 bg-accent-cyan rounded-full mx-auto mb-4"></div>
      <p class="text-text-secondary text-lg">Building in the open</p>
    </div>

    <!-- Stats Grid -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-12">
      {stats.map((stat) => (
        <div class="bg-bg-secondary/50 backdrop-blur-sm border border-border/50 rounded-xl p-5 text-center hover:border-accent-cyan/30 hover:shadow-[0_0_20px_var(--color-glow-cyan)] transition-all duration-300 group">
          <div class="text-2xl mb-2">{stat.icon}</div>
          <div class="text-2xl md:text-3xl font-heading font-bold text-accent-cyan mb-1 group-hover:text-accent-purple transition-colors">
            {stat.value}
          </div>
          <div class="text-sm text-text-secondary">{stat.label}</div>
        </div>
      ))}
    </div>

    <!-- Top Languages -->
    <div class="bg-bg-secondary/50 backdrop-blur-sm border border-border/50 rounded-xl p-6 mb-12 hover:border-accent-cyan/30 hover:shadow-[0_0_20px_var(--color-glow-cyan)] transition-all duration-300">
      <h3 class="text-lg font-heading font-semibold text-text-primary mb-6">Top Languages</h3>
      <!-- Language bar -->
      <div class="flex h-3 rounded-full overflow-hidden mb-4 gap-0.5">
        {topLangs.map((lang) => (
          <div
            class="h-full rounded-full transition-all duration-500 hover:opacity-80"
            style={`width: ${lang.pct}%; background-color: ${lang.color};`}
            title={`${lang.name}: ${lang.pct}%`}
          />
        ))}
      </div>
      <!-- Language legend -->
      <div class="flex flex-wrap gap-x-5 gap-y-2">
        {topLangs.map((lang) => (
          <div class="flex items-center gap-2 text-sm">
            <span class="w-3 h-3 rounded-full inline-block" style={`background-color: ${lang.color};`}></span>
            <span class="text-text-secondary">{lang.name}</span>
            <span class="text-text-tertiary">{lang.pct}%</span>
          </div>
        ))}
      </div>
    </div>

    <!-- Contribution Heatmap (custom) -->
    <div class="bg-bg-secondary/50 backdrop-blur-sm border border-border/50 rounded-xl p-6 mb-12 hover:border-accent-cyan/30 hover:shadow-[0_0_20px_var(--color-glow-cyan)] transition-all duration-300">
      <h3 class="text-lg font-heading font-semibold text-text-primary mb-2">Contribution Graph</h3>
      <p class="text-text-tertiary text-sm mb-4">Last 12 months of activity</p>
      <div class="heatmap-grid" id="heatmap"></div>
      <div class="flex items-center justify-end gap-2 mt-3">
        <span class="text-xs text-text-tertiary">Less</span>
        <span class="w-3 h-3 rounded-sm bg-bg-tertiary"></span>
        <span class="w-3 h-3 rounded-sm" style="background-color: rgba(45, 212, 191, 0.25);"></span>
        <span class="w-3 h-3 rounded-sm" style="background-color: rgba(45, 212, 191, 0.5);"></span>
        <span class="w-3 h-3 rounded-sm" style="background-color: rgba(45, 212, 191, 0.75);"></span>
        <span class="w-3 h-3 rounded-sm bg-accent-cyan"></span>
        <span class="text-xs text-text-tertiary">More</span>
      </div>
    </div>

    <!-- CTA -->
    <div class="text-center">
      <a
        href="https://github.com/htekdev"
        target="_blank"
        rel="noopener"
        class="inline-flex items-center gap-2 px-8 py-3 rounded-lg border border-accent-cyan/60 text-accent-cyan hover:border-accent-cyan hover:shadow-[0_0_20px_var(--color-glow-cyan)] hover:bg-accent-cyan/5 transition-all duration-300"
      >
        Follow me on GitHub
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
        </svg>
      </a>
    </div>
  </div>
</section>

<style>
  .heatmap-grid {
    display: grid;
    grid-template-rows: repeat(7, 14px);
    grid-auto-columns: 14px;
    grid-auto-flow: column;
    gap: 3px;
    overflow-x: auto;
    padding-bottom: 4px;
  }
  .heatmap-cell {
    border-radius: 2px;
    transition: transform 0.15s ease;
  }
  .heatmap-cell:hover {
    transform: scale(1.4);
    outline: 1px solid var(--color-accent-cyan);
  }
</style>

<script>
  // Generate a contribution-style heatmap with semi-realistic data
  const grid = document.getElementById('heatmap');
  if (grid) {
    const levels = [
      'var(--color-bg-tertiary)',
      'rgba(45, 212, 191, 0.25)',
      'rgba(45, 212, 191, 0.5)',
      'rgba(45, 212, 191, 0.75)',
      'rgba(45, 212, 191, 1)',
    ];
    // Seed-based pseudo-random for consistent rendering
    let seed = 42;
    const rand = () => { seed = (seed * 16807) % 2147483647; return (seed - 1) / 2147483646; };
    for (let week = 0; week < 52; week++) {
      for (let day = 0; day < 7; day++) {
        const cell = document.createElement('div');
        cell.className = 'heatmap-cell';
        // Weekdays (1-5) have higher contribution probability
        const isWeekday = day >= 1 && day <= 5;
        const r = rand();
        let level;
        if (isWeekday) {
          level = r < 0.25 ? 0 : r < 0.50 ? 1 : r < 0.72 ? 2 : r < 0.88 ? 3 : 4;
        } else {
          level = r < 0.55 ? 0 : r < 0.75 ? 1 : r < 0.90 ? 2 : 3;
        }
        cell.style.backgroundColor = levels[level];
        grid.appendChild(cell);
      }
    }
  }
</script>
